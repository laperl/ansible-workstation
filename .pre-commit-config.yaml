---
ci:
  autoupdate_schedule: monthly

repos:
  # 1) Herramientas b√°sicas (estas funcionan bien en remoto)
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: end-of-file-fixer
        exclude: '.*\.sops\.ya?ml$'
      - id: trailing-whitespace
        exclude: '.*\.sops\.ya?ml$'
      - id: check-added-large-files

  # 2) HERRAMIENTAS LOCALES (Estrategia Guru para evitar errores de entorno)
  - repo: local
    hooks:
      - id: yamllint
        name: yamllint
        entry: yamllint
        language: system
        types: [yaml]
        args: [-c, .yamllint]
        exclude: '.*\.sops\.ya?ml$'

      - id: ansible-lint
        name: ansible-lint
        entry: ansible-lint
        language: system
        types: [yaml]
        # Solo ejecutar en archivos que parezcan de Ansible
        files: |
          (?x)^(?!.*\.sops\.ya?ml$)(
            ansible\.cfg|
            (playbooks|roles|tasks|handlers|group_vars|host_vars|inventory|collections|plugins)/.*\.(yml|yaml)|
            (site|main|playbook).*\.ya?ml
          )$
        exclude: '^secrets/|^dotfiles/'
